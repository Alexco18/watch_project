<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>ChronoBase â€“ DÃ©tails montre</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: radial-gradient(circle at top, #1a1a1a 0%, #0b0b0b 60%, #000 100%);
      color: #d4af37;
    }

    header {
      position: fixed;
      top: 0;
      width: 100%;
      background: #0b0b0b;
      border-bottom: 1px solid rgba(212,175,55,0.2);
      padding: 12px 0;
      z-index: 10;
    }

    .header-container {
      max-width: 1200px;
      margin: auto;
      padding: 0 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    /* ðŸ”¥ Nouvelle grille : colonne gauche = image + biblio */
    .watch-page {
      max-width: 1200px;
      margin: auto;
      padding: 140px 20px 80px;
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 50px;
    }

    /* ðŸ”¥ Image carrÃ©e */
    .watch-gallery img {
      width: 100%;
      height: 350px;
      object-fit: cover;
      border-radius: 12px;
      margin-bottom: 20px;
      border: 1px solid rgba(212,175,55,0.2);
    }

    .watch-details h1 {
      font-size: 42px;
      font-weight: 300;
      margin-bottom: 20px;
    }

    .watch-details p {
      color: #c1a96b;
      line-height: 1.7;
      margin-bottom: 30px;
    }

    .watch-specs {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .watch-specs li {
      padding: 10px 0;
      border-bottom: 1px solid rgba(212,175,55,0.2);
      display: flex;
      justify-content: space-between;
    }

    .watch-price {
      font-size: 26px;
      margin-top: 30px;
    }

    .pdf-button {
      background: #d4af37;
      color: #000;
      padding: 10px 15px;
      border-radius: 6px;
      cursor: pointer;
      border: none;
      font-weight: 600;
      margin-top: 10px;
    }
    .pdf-button:hover {
      background: #f5d98c;
    }

    @media (max-width: 900px) {
      .watch-page {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>

<header>
  <div class="header-container">
    <h2>ChronoBase</h2>
    <nav>
      <a onclick="history.back()" style="cursor:pointer;color:#d4af37;text-decoration:none;">Retour</a>
    </nav>
  </div>
</header>

<section class="watch-page">

  <!-- â­ COLONNE GAUCHE : IMAGE + BIBLIO -->
  <div>
    <div class="watch-gallery" id="gallery"></div>

    <h3>Bibliographie</h3>
    <ul id="watch-bibliography" class="watch-specs"></ul>
    <p id="bibliography-note" style="margin-top:10px;color:#c1a96b;"></p>

    <button id="report-error" class="pdf-button" style="margin-top:20px;">
      Signaler une erreur / information incorrecte
    </button>
  </div>

  <!-- â­ COLONNE DROITE : INFOS -->
  <div class="watch-details">
    <h1 id="watch-title"></h1>
    <p id="watch-description"></p>

    <ul class="watch-specs" id="specs"></ul>

    <div class="watch-price" id="price"></div>

    <h3>Histoire & Contexte</h3>
    <p id="watch-history"></p>

    <h3>Notes & RÃ©fÃ©rences</h3>
    <p id="watch-notes"></p>

    <h3>Demander le PDF complet</h3>
    <button id="pdf-btn" class="pdf-button">Demander le PDF</button>

    <div id="pdf-form" style="display:none; margin-top:15px;">

      <label>Votre tranche d'Ã¢ge :</label>
      <select id="age-range">
        <option value="">SÃ©lectionner</option>
        <option value="moins de 18">Moins de 18 ans</option>
        <option value="18-25">18â€“25 ans</option>
        <option value="26-35">26â€“35 ans</option>
        <option value="36-50">36â€“50 ans</option>
        <option value="50+">Plus de 50 ans</option>
      </select>

      <br><br>

      <label>Genre :</label>
      <select id="gender">
        <option value="">SÃ©lectionner</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
        <option value="Non-binaire">Non-binaire</option>
      </select>

      <br><br>

      <label>Domaine professionnel :</label>
      <select id="domain" onchange="checkDomain()">
        <option value="">SÃ©lectionner</option>
        <option value="Horlogerie">Horlogerie</option>
        <option value="Luxe">Luxe</option>
        <option value="Industrie">Industrie</option>
        <option value="Commerce">Commerce</option>
        <option value="Ã‰tudiant">Ã‰tudiant</option>
        <option value="Autre">Autre</option>
      </select>

      <br><br>

      <div id="job-field" style="display:none;">
        <label>IntitulÃ© exact du mÃ©tier :</label>
        <input type="text" id="job-title" placeholder="Ex : Horloger, Polisseur, Vendeur spÃ©cialisÃ©...">
        <br><br>
      </div>

      <button id="send-mail" class="pdf-button">Envoyer la demande</button>
    </div>

  </div>

</section>

<script>
window.WATCHES = [];
</script>

<script src="brands/lip.js"></script>
<script src="brands/rolex.js"></script>
<script src="brands/swatch.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

const watch = window.WATCHES.find(w => w.id === id);

if (!watch) {
  document.body.innerHTML = "<h1 style='padding:150px;text-align:center;'>Montre introuvable</h1>";
  throw new Error("Montre introuvable : " + id);
}

document.getElementById("watch-title").textContent =
  `${watch.brand} â€“ ${watch.name} (${watch.year})`;

document.getElementById("watch-description").textContent =
  watch.description || "Aucune description disponible.";

document.getElementById("specs").innerHTML = (watch.specs || [])
  .map(s => `<li><span>${s.label}</span><span>${s.value}</span></li>`)
  .join("");

document.getElementById("price").innerHTML =
  watch.price ? `Prix estimÃ© : <strong>${watch.price}</strong>` : "";

document.getElementById("watch-history").textContent = watch.history;
document.getElementById("watch-notes").textContent = watch.notes;

/* â­ GALERIE */
const gallery = document.getElementById("gallery");

if (watch.images && watch.images.length > 0) {
  gallery.innerHTML = watch.images
    .map(img => `<img src="${img}" alt="${watch.name}">`)
    .join("");
} else {
  gallery.innerHTML = `<img src="${watch.img}" alt="${watch.name}">`;
}

/* â­ BIBLIOGRAPHIE */
const biblioList = document.getElementById("watch-bibliography");

if (watch.bibliography && watch.bibliography.length > 0) {
  biblioList.innerHTML = watch.bibliography
    .map(b => `<li><a href="${b.url}" target="_blank" style="color:#d4af37;">${b.label}</a></li>`)
    .join("");
} else {
  biblioList.innerHTML = "<li>Aucune source disponible.</li>";
}

document.getElementById("bibliography-note").textContent =
  watch.bibliography_note || "";

/* â­ SIGNALER UNE ERREUR */
document.getElementById("report-error").onclick = () => {
  const mailBody = `
Signalement d'erreur concernant la montre : ${watch.name}

Merci d'indiquer ce qui vous semble incorrect :
- (ex : faute d'orthographe, mauvaise information technique, lien cassÃ©...)

-------------------------
Votre message :
`;

  const mailto = `mailto:contact@chronobase.com?subject=Signalement â€“ ${watch.name}&body=${encodeURIComponent(mailBody)}`;
  window.location.href = mailto;
};

/* â­ FORMULAIRE PDF */
document.getElementById("pdf-btn").onclick = () => {
  document.getElementById("pdf-form").style.display = "block";
};

function checkDomain() {
  const domain = document.getElementById("domain").value;
  document.getElementById("job-field").style.display =
    domain === "Horlogerie" ? "block" : "none";
}

document.getElementById("send-mail").onclick = () => {
  const age = document.getElementById("age-range").value;
  const gender = document.getElementById("gender").value;
  const domain = document.getElementById("domain").value;
  const job = document.getElementById("job-title").value;

  let body = `
Demande de PDF pour la montre : ${watch.name}

Informations utilisateur :
- Tranche d'Ã¢ge : ${age}
- Genre : ${gender}
- Domaine professionnel : ${domain}
`;

  if (domain === "Horlogerie") {
    body += `- MÃ©tier exact : ${job}\n`;
  }

  body += `\nMerci d'envoyer le PDF complet Ã  cette personne.\n`;

  const mailto = `mailto:contact@chronobase.com?subject=Demande PDF â€“ ${watch.name}&body=${encodeURIComponent(body)}`;

  window.location.href = mailto;
};
</script>

</body>
</html>
