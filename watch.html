<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>ChronoBase – Détails montre</title>

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500&display=swap" rel="stylesheet">

  <style>
/* ---------------------- VARIABLES ---------------------- */
:root {
  --gold-gradient: linear-gradient(90deg,#d4af37,#f5d98c,#c8a951);

  /* Thème sombre */
  --bg-main: radial-gradient(circle at top,#1a1a1a 0%,#0b0b0b 60%,#000 100%);
  --bg-header: #0b0b0b;
  --bg-card: linear-gradient(180deg,#111,#0c0c0c);

  --text-main: #d4af37;
  --text-secondary: #c1a96b;

  --border-color: rgba(212,175,55,0.2);
}

/* Thème clair */
.light-theme {
  --bg-main: #ffffff;
  --bg-header: #ffffff;
  --bg-card: #ffffff;

  --text-main: #000000;
  --text-secondary: #444444;

  --border-color: rgba(0,0,0,0.2);
}

/* ---------------------- GLOBAL ---------------------- */
body {
  margin: 0;
  font-family: 'Montserrat', sans-serif;
  background: var(--bg-main);
  color: var(--text-main);
}

/* ---------------------- HEADER ---------------------- */
header {
  position: fixed;
  top: 0;
  width: 100%;
  background: var(--bg-header);
  border-bottom: 1px solid var(--border-color);
  padding: 12px 0;
  z-index: 10;
}

.header-container {
  max-width: 1200px;
  margin: auto;
  padding: 0 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.header-left {
  display: flex;
  align-items: center;
  gap: 15px;
}

nav a {
  cursor: pointer;
  color: var(--text-main);
  text-decoration: none;
  font-size: 14px;
  letter-spacing: 1px;
  text-transform: uppercase;
}
nav a:hover { color: #f5d98c; }

/* ---------------------- SWITCH MODE SOMBRE/CLAIR ---------------------- */
#theme-switch {
  width: 50px;
  height: 26px;
  background: var(--border-color);
  border-radius: 20px;
  position: relative;
  cursor: pointer;
  transition: background 0.3s;
  display: flex;
  align-items: center;
  padding: 3px;
}

.switch-handle {
  width: 20px;
  height: 20px;
  background: var(--text-main);
  border-radius: 50%;
  transition: transform 0.3s, background 0.3s;
}

.light-theme #theme-switch .switch-handle {
  transform: translateX(24px);
  background: #000;
}

/* ---------------------- PAGE ---------------------- */
.watch-page {
  max-width: 1200px;
  margin: auto;
  padding: 140px 20px 80px;
  display: grid;
  grid-template-columns: 400px 1fr;
  gap: 50px;
}

.watch-gallery img {
  width: 100%;
  height: 350px;
  object-fit: cover;
  border-radius: 12px;
  margin-bottom: 20px;
  border: 1px solid var(--border-color);
}

.watch-details h1 {
  font-size: 42px;
  font-weight: 300;
  margin-bottom: 20px;
}

.watch-details p {
  color: var(--text-secondary);
  line-height: 1.7;
  margin-bottom: 30px;
}

.watch-specs {
  list-style: none;
  padding: 0;
  margin: 0;
}

.watch-specs li {
  padding: 10px 0;
  border-bottom: 1px solid var(--border-color);
  display: flex;
  justify-content: space-between;
}

.watch-price {
  font-size: 26px;
  margin-top: 30px;
}

.pdf-button {
  background: #d4af37;
  color: #000;
  padding: 10px 15px;
  border-radius: 6px;
  cursor: pointer;
  border: none;
  font-weight: 600;
  margin-top: 10px;
}
.pdf-button:hover {
  background: #f5d98c;
}

@media (max-width: 900px) {
  .watch-page {
    grid-template-columns: 1fr;
  }
}
  </style>
</head>

<body>

<header>
  <div class="header-container">

    <div class="header-left">
      <h2>ChronoBase</h2>

      <!-- Switch thème -->
      <div id="theme-switch" onclick="toggleTheme()">
        <div class="switch-handle"></div>
      </div>
    </div>

    <nav>
      <a onclick="history.back()">Retour</a>
    </nav>

  </div>
</header>

<section class="watch-page">

  <!-- ⭐ COLONNE GAUCHE : IMAGE + BIBLIO -->
  <div>
    <div class="watch-gallery" id="gallery"></div>

    <h3>Bibliographie</h3>
    <ul id="watch-bibliography" class="watch-specs"></ul>
    <p id="bibliography-note" style="margin-top:10px;color:var(--text-secondary);"></p>

    <button id="report-error" class="pdf-button" style="margin-top:20px;">
      Signaler une erreur / information incorrecte
    </button>
  </div>

  <!-- ⭐ COLONNE DROITE : INFOS -->
  <div class="watch-details">
    <h1 id="watch-title"></h1>
    <p id="watch-description"></p>

    <ul class="watch-specs" id="specs"></ul>

    <div class="watch-price" id="price"></div>

    <h3>Histoire & Contexte</h3>
    <p id="watch-history"></p>

    <h3>Notes & Références</h3>
    <p id="watch-notes"></p>

    <h3>Demander le PDF complet</h3>
    <button id="pdf-btn" class="pdf-button">Demander le PDF</button>

    <div id="pdf-form" style="display:none; margin-top:15px;">

      <label>Votre tranche d'âge :</label>
      <select id="age-range">
        <option value="">Sélectionner</option>
        <option value="moins de 18">Moins de 18 ans</option>
        <option value="18-25">18–25 ans</option>
        <option value="26-35">26–35 ans</option>
        <option value="36-50">36–50 ans</option>
        <option value="50+">Plus de 50 ans</option>
      </select>

      <br><br>

      <label>Genre :</label>
      <select id="gender">
        <option value="">Sélectionner</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
        <option value="Non-binaire">Non-binaire</option>
      </select>

      <br><br>

      <label>Domaine professionnel :</label>
      <select id="domain" onchange="checkDomain()">
        <option value="">Sélectionner</option>
        <option value="Horlogerie">Horlogerie</option>
        <option value="Luxe">Luxe</option>
        <option value="Industrie">Industrie</option>
        <option value="Commerce">Commerce</option>
        <option value="Étudiant">Étudiant</option>
        <option value="Autre">Autre</option>
      </select>

      <br><br>

      <div id="job-field" style="display:none;">
        <label>Intitulé exact du métier :</label>
        <input type="text" id="job-title" placeholder="Ex : Horloger, Polisseur, Vendeur spécialisé...">
        <br><br>
      </div>

      <button id="send-mail" class="pdf-button">Envoyer la demande</button>
    </div>

  </div>

</section>

<script>
window.WATCHES = [];
</script>

<script src="brands/lip.js"></script>
<script src="brands/rolex.js"></script>
<script src="brands/swatch.js"></script>
<script src="brands/omega.js"></script>

<script>
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

const watch = window.WATCHES.find(w => w.id === id);

if (!watch) {
  document.body.innerHTML = "<h1 style='padding:150px;text-align:center;'>Montre introuvable</h1>";
  throw new Error("Montre introuvable : " + id);
}

document.getElementById("watch-title").textContent =
  `${watch.brand} – ${watch.name} (${watch.year})`;

document.getElementById("watch-description").textContent =
  watch.description || "Aucune description disponible.";

document.getElementById("specs").innerHTML = (watch.specs || [])
  .map(s => `<li><span>${s.label}</span><span>${s.value}</span></li>`)
  .join("");

document.getElementById("price").innerHTML =
  watch.price ? `Prix estimé : <strong>${watch.price}</strong>` : "";

document.getElementById("watch-history").textContent = watch.history;
document.getElementById("watch-notes").textContent = watch.notes;

/* ⭐ GALERIE */
const gallery = document.getElementById("gallery");

if (watch.images && watch.images.length > 0) {
  gallery.innerHTML = watch.images
    .map(img => `<img src="${img}" alt="${watch.name}">`)
    .join("");
} else {
  gallery.innerHTML = `<img src="${watch.img}" alt="${watch.name}">`;
}

/* ⭐ BIBLIOGRAPHIE */
const biblioList = document.getElementById("watch-bibliography");

if (watch.bibliography && watch.bibliography.length > 0) {
  biblioList.innerHTML = watch.bibliography
    .map(b => `<li><a href="${b.url}" target="_blank" style="color:var(--text-main);">${b.label}</a></li>`)
    .join("");
} else {
  biblioList.innerHTML = "<li>Aucune source disponible.</li>";
}

document.getElementById("bibliography-note").textContent =
  watch.bibliography_note || "";

/* ⭐ SIGNALER UNE ERREUR */
document.getElementById("report-error").onclick = () => {
  const mailBody = `
Signalement d'erreur concernant la montre : ${watch.name}

Merci d'indiquer ce qui vous semble incorrect :
- (ex : faute d'orthographe, mauvaise information technique, lien cassé...)

-------------------------
Votre message :
`;

  const mailto = `mailto:contact@chronobase.com?subject=Signalement – ${watch.name}&body=${encodeURIComponent(mailBody)}`;
  window.location.href = mailto;
};

/* ⭐ FORMULAIRE PDF */
document.getElementById("pdf-btn").onclick = () => {
  document.getElementById("pdf-form").style.display = "block";
};

function checkDomain() {
  const domain = document.getElementById("domain").value;
  document.getElementById("job-field").style.display =
    domain === "Horlogerie" ? "block" : "none";
}

document.getElementById("send-mail").onclick = () => {
  const age = document.getElementById("age-range").value;
  const gender = document.getElementById("gender").value;
  const domain = document.getElementById("domain").value;
  const job = document.getElementById("job-title").value;

  let body = `
Demande de PDF pour la montre : ${watch.name}

Informations utilisateur :
- Tranche d'âge : ${age}
- Genre : ${gender}
- Domaine professionnel : ${domain}
`;

  if (domain === "Horlogerie") {
    body += `- Métier exact : ${job}\n`;
  }

  body += `\nMerci d'envoyer le PDF complet à cette personne.\n`;

  const mailto = `mailto:contact@chronobase.com?subject=Demande PDF – ${watch.name}&body=${encodeURIComponent(body)}`;

  window.location.href = mailto;
};
</script>

<!-- ---------------------- SCRIPT THEME ---------------------- -->
<script>
function toggleTheme() {
  document.body.classList.toggle("light-theme");

  const isLight = document.body.classList.contains("light-theme");
  localStorage.setItem("theme", isLight ? "light" : "dark");
}

(function() {
  const saved = localStorage.getItem("theme");
  if (saved === "light") {
    document.body.classList.add("light-theme");
  }
})();
</script>

</body>
</html>
